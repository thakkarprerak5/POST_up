<!DOCTYPE html>
<html>
<head>
    <title>Test Profile Photo Display</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        .avatar { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
        .author-info { display: flex; align-items: center; gap: 10px; margin: 10px 0; }
        .project-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; font-family: monospace; font-size: 12px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
    </style>
</head>
<body>
    <h1>üñºÔ∏è Test Profile Photo Display</h1>
    
    <div class="test">
        <h3>Test 1: Direct Image Test</h3>
        <div class="author-info">
            <img 
                src="/placeholder-user.jpg" 
                alt="Test Avatar" 
                class="avatar"
                onerror="console.log('Direct img failed to load'); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                onload="console.log('Direct img loaded successfully');"
            />
            <div style="display: none; width: 32px; height: 32px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #6b7280;">
                T
            </div>
            <div>
                <div><strong>Test Avatar</strong></div>
                <small>Direct image test</small>
            </div>
        </div>
        <div id="direct-result" class="debug">Loading...</div>
    </div>
    
    <div class="test">
        <h3>Test 2: Ganpat Project Simulation</h3>
        <div id="ganpat-result">Loading...</div>
    </div>
    
    <div class="test">
        <h3>Test 3: SimpleProfilePhoto Simulation</h3>
        <div id="simple-result">Loading...</div>
    </div>

    <script>
        // Test 1: Direct image
        const directImg = document.querySelector('img[src="/placeholder-user.jpg"]');
        directImg.addEventListener('load', () => {
            document.getElementById('direct-result').innerHTML = '‚úÖ Direct image loaded successfully';
        });
        directImg.addEventListener('error', () => {
            document.getElementById('direct-result').innerHTML = '‚ùå Direct image failed to load';
        });
        
        // Test 2: Ganpat project simulation
        async function testGanpatProject() {
            try {
                const response = await fetch('/api/projects');
                const projects = await response.json();
                const ganpatProject = projects.find(p => p.author?.name === 'ganpat');
                
                if (ganpatProject) {
                    const imageUrl = ganpatProject.author.image || ganpatProject.author.avatar || '/placeholder-user.jpg';
                    
                    document.getElementById('ganpat-result').innerHTML = `
                        <div class="success">
                            <div class="author-info">
                                <img 
                                    src="${imageUrl}" 
                                    alt="${ganpatProject.author.name}" 
                                    class="avatar"
                                    onerror="console.log('Ganpat img failed to load:', '${imageUrl}'); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                                    onload="console.log('Ganpat img loaded successfully:', '${imageUrl}');"
                                />
                                <div style="display: none; width: 32px; height: 32px; border-radius: 50%; background: #e5e7eb; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #6b7280;">
                                    ${ganpatProject.author.name.charAt(0).toUpperCase()}
                                </div>
                                <div>
                                    <div><strong>${ganpatProject.author.name}</strong></div>
                                    <small>Ganpat project test</small>
                                </div>
                            </div>
                            <div class="debug">
                                API Data: ${ganpatProject.title}<br>
                                Image URL: ${imageUrl}<br>
                                Author ID: ${ganpatProject.author.id}
                            </div>
                        </div>
                    `;
                    
                    // Add event listeners to dynamically created image
                    const ganpatImg = document.querySelector('#ganpat-result img');
                    ganpatImg.addEventListener('load', () => {
                        document.getElementById('ganpat-result').innerHTML += '<div class="debug">‚úÖ Ganpat image loaded successfully</div>';
                    });
                    ganpatImg.addEventListener('error', () => {
                        document.getElementById('ganpat-result').innerHTML += '<div class="debug">‚ùå Ganpat image failed to load</div>';
                    });
                } else {
                    document.getElementById('ganpat-result').innerHTML = '‚ùå Ganpat project not found';
                }
            } catch (error) {
                document.getElementById('ganpat-result').innerHTML = `‚ùå Error: ${error.message}`;
            }
        }
        
        // Test 3: SimpleProfilePhoto simulation
        function simulateSimpleProfilePhoto() {
            const imageUrl = '/placeholder-user.jpg';
            const authorName = 'ganpat';
            
            document.getElementById('simple-result').innerHTML = `
                <div class="success">
                    <div class="author-info">
                        <div class="relative w-8 h-8 rounded-full overflow-hidden cursor-pointer">
                            <img
                                src="${imageUrl}"
                                alt="${authorName}"
                                class="w-full h-full object-cover"
                                onerror="console.log('SimpleProfilePhoto: Image failed to load:', '${imageUrl}'); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                                onload="console.log('SimpleProfilePhoto: Image loaded successfully:', '${imageUrl}');"
                                style="display: block;"
                            />
                            <div class="absolute inset-0 w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium opacity-0 hover:opacity-100 transition-opacity" style="display: none;">
                                ${authorName.charAt(0).toUpperCase()}
                            </div>
                        </div>
                        <div>
                            <div><strong>${authorName}</strong></div>
                            <small>SimpleProfilePhoto simulation</small>
                        </div>
                    </div>
                    <div class="debug">
                        Component Logic: For ganpat, always use /placeholder-user.jpg<br>
                        Image URL: ${imageUrl}<br>
                        This should work exactly like the React component
                    </div>
                </div>
            `;
            
            // Add event listeners to dynamically created image
            const simpleImg = document.querySelector('#simple-result img');
            simpleImg.addEventListener('load', () => {
                document.getElementById('simple-result').innerHTML += '<div class="debug">‚úÖ SimpleProfilePhoto image loaded successfully</div>';
            });
            simpleImg.addEventListener('error', () => {
                document.getElementById('simple-result').innerHTML += '<div class="debug">‚ùå SimpleProfilePhoto image failed to load</div>';
            });
        }
        
        // Run tests
        window.onload = () => {
            console.log('üîç Starting Profile Photo Display Tests');
            testGanpatProject();
            simulateSimpleProfilePhoto();
            
            console.log('üéØ Test Instructions:');
            console.log('1. All three tests should show profile photos');
            console.log('2. Check browser console for loading messages');
            console.log('3. If direct image works, the issue is in React component');
            console.log('4. If all work here, the main page should work too');
        };
    </script>
</body>
</html>
